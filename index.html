<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Safehouse Terminal</title>
<style>
    /* SETTINGS */
    :root {
        --title: "THE SAFEHOUSE";
        --subtitle: "Cocktail Bar and Shelter · Interface OS v1.3";
        --accent: #33ff66;
        --bg: #060806;
    }

    html, body { height: 100%; }
    body {
        margin: 0;
        color: var(--accent);
        background: var(--bg);
        font-family: "VT323", ui-monospace, Menlo, Consolas, monospace;
        font-size: clamp(14px, 2.2vw, 22px);
        line-height: 1.25;
        overflow: hidden;
        -webkit-user-select: none; user-select: none;
    }

    /* Fixed header always visible */
    .header {
        position: fixed; inset: 0 0 auto 0; height: 64px;
        display: grid; place-items: center;
        color: var(--accent); background: rgba(0,0,0,0.65);
        border-bottom: 1px solid rgba(51,255,102,.35);
        z-index: 20; text-align: center;
    }
    .header .t { font-size: clamp(18px,3.4vw,36px); letter-spacing:.06em; }
    .header .s { font-size: clamp(10px,2.2vw,16px); opacity:.85; margin-top:.15rem; }

    /* CRT screen */
    .screen { position: absolute; inset: 64px 0 0 0; padding: 1rem 1.25rem; }
    .tube {
        height: 100svh; /* mobile friendly viewport height */
        width: 100vw; position: relative; overflow: hidden;
        background: radial-gradient(120% 90% at 50% 50%, #0a140a 0%, #050805 70%, #020402 100%);
        box-shadow: inset 0 0 18px #0b3; border-top:1px solid #0b3;
    }
    .tube::before { /* scanlines */
        content:""; position:absolute; inset:0; pointer-events:none; z-index:2;
        background: repeating-linear-gradient(to bottom, transparent 0 2px, rgba(0,0,0,.22) 3px, transparent 4px);
        opacity:.6;
    }

    /* Terminal body */
    #terminal { position:absolute; inset:0; padding: 1rem 1.25rem 5.5rem; overflow:auto; z-index:1; white-space:pre-wrap; }

    /* Prompt (mobile-safe) */
    .promptBar {
        position: fixed; left:0; right:0; bottom:0; height: 64px; z-index: 25;
        display:flex; align-items:center; gap:.5rem; padding:.75rem 1rem;
        background:rgba(0,0,0,.8); border-top:1px solid rgba(51,255,102,.35);
    }
    .caret { animation: blink 1.1s steps(2,start) infinite; }
    @keyframes blink { 50% { opacity:0 } }

    .visibleInput { flex:1; min-height:1.2em }
    #realInput { position:absolute; opacity:0; left:-9999px; }

    /* On‑screen quick keys after HELP */
    .keys { display:flex; gap:.5rem; overflow-x:auto; padding:.4rem 1rem; }
    .key { border:1px solid rgba(51,255,102,.4); padding:.35rem .6rem; border-radius:6px; background:rgba(0,0,0,.35); }
    .key:active{ transform:scale(.98) }

    /* Touch helpers */
    .tap { color:var(--accent); opacity:.9; }
</style>
</head>
<body>
  <div class="header">
    <div>
      <div class="t">THE SAFEHOUSE</div>
      <div class="s">Cocktail Bar and Shelter · Interface OS v1.3</div>
    </div>
  </div>

  <div class="screen">
    <div class="tube">
      <div id="terminal"></div>
    </div>
  </div>

  <div class="promptBar" id="promptBar" style="display:none">
    <span>&gt;</span>
    <span class="visibleInput" id="visibleText"></span>
    <span class="caret">_</span>
    <input id="realInput" type="text" inputmode="text" autocomplete="off" autocapitalize="none" autocorrect="off" />
  </div>
  <div class="keys" id="keys" style="display:none"></div>

  <script>
    const term = document.getElementById('terminal');
    const real = document.getElementById('realInput');
    const vis = document.getElementById('visibleText');
    const bar = document.getElementById('promptBar');
    const keys = document.getElementById('keys');

    const BOOT1 = [
      '> POWERING UP TERMINAL...',
      '> LOADING BIOS... OK',
      '> SAFEHOUSE SYSTEM INTERFACE v1.3',
      '> SCANNING MEMORY... OK',
      '> LOADING MODULES... OK',
      '> WELCOME, USER.',
      '  THE SAFEHOUSE',
      '  ------------------------------',
      '  PUBLIC ACCESS TERMINAL',
      '',
      '  PRESS ANY KEY OR TAP TO CONTINUE'
    ];

    const BOOT2 = [
      '> ACCESS GRANTED.',
      '> INITIALIZING TERMINAL...',
      '> CONNECTION ESTABLISHED.',
      "> TYPE 'HELP' FOR AVAILABLE COMMANDS"
    ];

    const COMMANDS = {
      'HELP': () => {
        const list = [
          '1. HOME        [intro]',
          '2. CONTACT     [social / lines]',
          '3. LOCATION    [map & coords]',
          '4. HOURS       [schedule]',
          '5. MAP         [open Google Maps]',
          '6. CLEAR       [wipe screen]' 
        ];
        showKeys(['1','2','3','4','5','6']);
        return list.join('
');
      },
      '1': ()=>'Welcome to THE SAFEHOUSE. A bunker bar for the wasteland.',
      'HOME': ()=>'Welcome to THE SAFEHOUSE. A bunker bar for the wasteland.',
      '2': ()=>'Instagram: @thesafehouse — contact@safehouse.example',
      'CONTACT': ()=>'Instagram: @thesafehouse — contact@safehouse.example',
      '3': ()=>'Sapporo — Susukino Sector. Coords: 43.0556, 141.3537',
      'LOCATION': ()=>'Sapporo — Susukino Sector. Coords: 43.0556, 141.3537',
      '4': ()=>'Mon–Thu 18:00–01:00 | Fri–Sat 18:00–03:00 | Sun Closed',
      'HOURS': ()=>'Mon–Thu 18:00–01:00 | Fri–Sat 18:00–03:00 | Sun Closed',
      '5': ()=>{ window.open('https://maps.google.com/?q=43.0556,141.3537','_blank'); return 'Opening map...'; },
      'MAP': ()=>COMMANDS['5'](),
      '6': ()=>{ clearTerm(); return "> TYPE 'HELP' FOR AVAILABLE COMMANDS"; },
      'CLEAR': ()=>COMMANDS['6']()
    };

    function println(t=''){ term.textContent += t + '
'; term.scrollTop = term.scrollHeight; }

    function typeLines(lines, i=0, delay=160, done){
      if(i>=lines.length){ done&&done(); return; }
      println(lines[i]); setTimeout(()=>typeLines(lines,i+1,delay,done), delay);
    }

    function start(){ typeLines(BOOT1,0,180, ()=> waitKey(() => secondBoot())); }

    function waitKey(cb){
      const once = ()=>{ window.removeEventListener('keydown',once); window.removeEventListener('pointerdown',once); cb(); };
      window.addEventListener('keydown', once, {once:true});
      window.addEventListener('pointerdown', once, {once:true});
    }
    function secondBoot(){ term.textContent=''; typeLines(BOOT2,0,160, ()=>{ showPrompt(); println(''); }); }

    function showPrompt(){ bar.style.display='flex'; focusInput(); }
    function focusInput(){ real.value=''; vis.textContent=''; real.style.left='0'; real.focus(); setTimeout(()=>{ if(document.activeElement!==real) real.focus(); }, 60); }

    real.addEventListener('input', ()=> vis.textContent = real.value);
    real.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); submit(real.value); }});

    function submit(raw){ const shown = raw; const cmd = (raw||'').trim().toUpperCase(); println('> ' + shown); real.value=''; vis.textContent=''; hideKeys();
      if(!cmd) return; const fn = COMMANDS[cmd]; if(fn){ const out = fn(); if(out) println(out); } else { println("UNKNOWN COMMAND. TYPE 'HELP'"); } }

    function clearTerm(){ const preserve = term; term.textContent=''; hideKeys(); }

    function showKeys(nums){ keys.style.display='flex'; keys.innerHTML = nums.map(n=>`<button class="key" data-k="${n}">${n}</button>`).join('');
      keys.querySelectorAll('.key').forEach(btn=>btn.addEventListener('click',()=>{ submit(btn.dataset.k); focusInput(); }));
    }
    function hideKeys(){ keys.style.display='none'; keys.innerHTML=''; }

    // Start
    start();
  </script>
</body>
</html>
